[HTTP2_Rapid_Reset_Full_Writeup.docx](https://github.com/user-attachments/files/25288277/HTTP2_Rapid_Reset_Full_Writeup.docx)

Breaking down the HTTP/2 Rapid Reset DDoS Attack in Autumn 2023 and what it reveals to about defending the Internet on a worldwide scale.
      I decided to take a deeper look into the HTTP/2 Rapid Reset DDoS attack not only because it was a record-breaking traffic spike that Cloudflare mitigated, reaching nearly 200 million requests per second, roughly three times larger than the previous record, but because of the creativity and subtlety of the attack itself. It stood out to me because there were no obvious signs of malicious intentions/signals, it exploited a feature of the standard protocol called stream multiplexing. By creating, cancelling and repeating requests under valid HTTP/2 frames. Rapidly sending and resetting streams allowed the attackers to induce significant server-side work without maintaining long-lived connections or transferring large amounts of data.
      HTTP/2 is a protocol that allows clients to open multiple streams over a single TCP connection. This is a nice feature that provides convenience to clients so they can send many requests efficiently without having to reopen connections. This efficiency is critical at Cloudflare s scale, where the company supports major platforms such as Discord, Reddit, Cisco and even government infrastructure. And the Rapid Reset attack abused features built into these protocols and systems by repeatedly opening streams, sending requests and immediately cancelling those requests hundreds of millions of times a second. 
      Cloudflare sits at the top of the internet in terms of handling absurd amounts of HTTP traffic every second. Attacks like this, which abuse protocol-compliant behaviour rather than malformed traffic to me feel exactly like the problem Cloudflare's Red Team must consider daily, and it represents the huge threats that the modern internet incurs and the type of creative security that needs to be implemented to deal with these threats.
      This attack is exceedingly sophisticated from an attackers perspective, instead of the conventional approach of trying to overwhelm a server with high loads of raw traffic potentially with many botnets to increase the load, this attack shifts a focus towards efficiency and silence by prioritising the maximum amount of work per request rather than the maximum amount of bytes transmitted per second. The fact that this attack was carried out using a botnet of roughly 20,000 machines, very small by modern standards, highlights how effective this approach was. It's clear that their approach to this attack was optimising a low-cost strategy for the attacker for a high cost on the defender's side while evading traditional malicious signals of DDoS attacks. 
      On the other side of the equation for Cloudflare, defending against an attack like this is very challenging for Cloudflare due to the scale of the attack and Cloudflare's role on the internet. Cloudflare handles legitimate HTTP/2 traffic from millions of clients and apps every second, and many clients also constantly reset streams for many valid reasons such as users rapidly scrolling through a page like Wikipedia causing the browser to create requests for potential images or content on the page then cancelling those requests as the user is no longer viewing that specific content, therefore saving bandwidth. Or closing tabs which would immediately cancel all active requests in that tab etc. Therefore, making it difficult to distinguish between malicious and legitimate requests without risking damages to requests of real clients, blocking traffic to aggressively could disrupt actual clientele and blocking traffic too slowly could allow a great deal of harm to occur to the system. This is where Cloudflare's Red Team needs to be at the top of their game in terms of security as all defensive measures need to be rapid, accurate, and safe for all legitimate users without risking a worldwide disruption.
      Cloudflare's existing protections were mostly able to absorb the brunt of the attack, initially affecting around 1% of the requests during the initial wave of attacks as stated in the blog Cloudflare, working alongside Google and AWS, uploaded to provide information on this attack to the public and web server vendors that will be able to implement patches to defend against these innovative attacks in the future more effectively: https://blog.cloudflare.com/technical-breakdown-http2-rapid-reset-ddos-attack/ . Cloudflare implemented targeted mitigations that would identify abusive stream resetting behaviours without breaking valid HTTP/2 usage which ultimately brought the attack to a stop. Attacks of this scale highlight the importance of internet security and at scales of this magnitude, fixing issues and creating solutions often relies on cooperation between multiple organisations as they target more than just a simple company s servers but rather an entire internet network.
      From my research, my main takeaway from this incident is how creative hackers get year by year, being able to exploit features designed for performance and efficiency and manipulating them into becoming the backbone of a worldwide DDoS attack that could burnout servers and cause huge financial losses for millions of companies. Attacks such as this one have drastically changed my outlook on DDoS attacks, changing my usual association of a DDoS attack with a huge volume of traffic affecting the bandwidth of a server and slowing it down/potentially shutting it down, to a new creative approach of looking for points of fault in the features of a system that were never designed with adversarial abuse in mind and spinning those faults as leverage to initiate an attack. This makes me curious as to what comes next, what other kind protocol-level assumptions could be exploited in the future, perhaps focusing on other features of multiplexed protocols like HTTP/2 and SSH, or maybe a multi-vector combination of attacking via protocol abuse and the traditional approach of flooding a server with traffic; creating a new style of DDoS attack that could keep more hidden and be more effective. It seems as though the main themes of this attack other than efficiency and silence is the asymmetry of costs, making the defenders of a system aka Cloudflare do more of the work than the attackers itself, understanding this has helped me comprehend why Red Teams need to constantly test assumptions and keep up to date on all ends of their security before attackers have the chance to.
      To conclude, looking at the HTTP/2 Rapid Reset DDoS attack as a whole, what stands out to me the most is the sheer impact that can arise from activities that are technically allowed. This wasn't an instance of evident malicious traffic, rather a reminder that all protocols are built on the foundation of assumptions, and hackers are always probing at the points where those assumptions begin to fail using them as leverage. Therefore opening my eyes to new possibilities of DDoS attacks, where they didn't need overwhelming amounts of resources, they needed an efficient way of using the defenders strategies against themselves, making it clear that in today's society of daily immense technological advancements, defending the internet from DDoS attacks is as much about understanding systems acutely as it is about filtering traffic. It also puts into perspective the true difficulty of drawing a clean boundary between genuine and malicious behaviour, especially at the global scale. Features like the HTTP/2 designed to improve performance and reliability can become liabilities and any defensive response must ensure a balance between availability and security simultaneously. Putting yourself in these attackers' shoes brings to light that security is never static, it's forever advancing and changing. And as time passes and defensive measures improve, new liabilities may arise that attackers will continue to look out for and exploit. The real challenge, and the part about security that is the most fascinating to me, is anticipating those potential liabilities before they can be taken advantage of, rather than simply reacting to an attack that's already started/happened.

